%------------------------------------------------------%
% Properties of typing judgment
%------------------------------------------------------%

% Weakening lemma

%{
% not quite
rec oft_weak_top : [ ‚ä¢ oft Œî M A] ‚Üí [ ‚ä¢ sh_up M zero M']
‚Üí {X:[ ‚ä¢ var]} {B:[ ‚ä¢ tp]} [ ‚ä¢ oft (cons Œî X B ùüò) M' A] =
  fn d, sh ‚áí mlam X, B ‚áí case d of
  | [ ‚ä¢ oft/var _ PL UPD1 EXH1] ‚áí
    %| shu/v1 : lt k n ‚Üí sh_up (hyp k) n (hyp k)
    %| shu/v2 : leq n k ‚Üí sh_up (hyp k) n (hyp (suc k))
    ?
  | [ ‚ä¢ oft/lam SH1 OFT1] ‚áí
    let [ ‚ä¢ shu/lam SH2] = sh in
    %| shu/lam : sh_up M (suc n) M' ‚Üí sh_up (lam M) n (lam M')
     ?
  | [ ‚ä¢ oft/app OFT1 OFT2 MG1] ‚áí
    let [ ‚ä¢ shu/app SH1 SH2] = sh in
    let [ ‚ä¢ OFT1'] = oft_weak_top [ ‚ä¢ OFT1] [ ‚ä¢ SH1] [ ‚ä¢ X] [ ‚ä¢ B] in
    let [ ‚ä¢ OFT2'] = oft_weak_top [ ‚ä¢ OFT2] [ ‚ä¢ SH2] [ ‚ä¢ X] [ ‚ä¢ B] in
    [ ‚ä¢ oft/app OFT1' OFT2' (mg/c MG1 ‚Ä¢/us)]
  ;
}%