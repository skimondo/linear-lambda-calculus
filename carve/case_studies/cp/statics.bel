%======================================================%
% Statics of CP
%======================================================%

LF oft : obj â†’ lctx _ â†’ type =

| oft/fwd : 
  dual A A'
  â†’ upd Î” _ Y Y A' A' ğŸ™ ğŸ˜ Î”' â†’ upd Î”' _ X X A A ğŸ™ ğŸ˜ Î”'' â†’ exh Î”''
  â†’ oft (fwd X Y) Î”

| oft/close : 
  upd Î” _ X X â‘  â‘  ğŸ™ ğŸ˜ Î”' â†’ exh Î”'
  â†’ oft (close X) Î”

| oft/wait : 
  upd Î” _ X X âŠ¥ âŠ¥ ğŸ™ ğŸ˜ Î”'
  â†’ oft P Î”'
  â†’ oft (wait X P) Î”

| oft/out : 
  upd Î”â‚‚ _ X X (A âŠ— B) (A âŠ— B) ğŸ™ ğŸ˜ Î”â‚‚'
  â†’ merge Î”â‚ Î”â‚‚ Î”
  â†’ ({x:obj} oft (P x) (cons Î”â‚ x A ğŸ™))
  â†’ ({x:obj} oft (Q x) (cons Î”â‚‚' x B ğŸ™))
  â†’ oft (out X P Q) Î”

| oft/inp :
  upd Î” _ X X (A â…‹ B) (A â…‹ B) ğŸ™ ğŸ˜ Î”'
  â†’ ({y:obj} {x:obj} oft (P y x) (cons (cons Î”' y B ğŸ™) x A ğŸ™))
  â†’ oft (inp X P) Î”

| oft/pcomp : 
  dual A A'
  â†’ merge Î”â‚ Î”â‚‚ Î”
  â†’ ({x:obj} oft (P x) (cons Î”â‚ x A ğŸ™))
  â†’ ({x:obj} oft (Q x) (cons Î”â‚‚ x A' ğŸ™))
  â†’ oft (pcomp A P Q) Î”

| oft/inl :
  upd Î” _ X X (A âŠ• B) (A âŠ• B) ğŸ™ ğŸ˜ Î”'
  â†’ ({x:obj} oft (P x) (cons Î”' x A ğŸ™))
  â†’ oft (inl X P) Î”

| oft/inr :
  upd Î” _ X X (A âŠ• B) (A âŠ• B) ğŸ™ ğŸ˜ Î”'
  â†’ ({x:obj} oft (P x) (cons Î”' x B ğŸ™))
  â†’ oft (inr X P) Î”

| oft/choice : 
  upd Î” _ X X (A & B) (A & B) ğŸ™ ğŸ˜ Î”'
  â†’ ({x:obj} oft (P x) (cons Î”' x A ğŸ™))
  â†’ ({x:obj} oft (Q x) (cons Î”' x B ğŸ™))
  â†’ oft (choice X P Q) Î”;