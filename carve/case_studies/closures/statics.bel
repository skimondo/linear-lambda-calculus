%======================================================%
% Typing rules for terms, environments, and values
%======================================================%

% M is of type A under the linear context Î”

LF oft : lctx _ â†’ obj â†’ tp â†’ type =
| oft/var : upd Î” n _ _ A A ğŸ™ ğŸ˜ Î”' â†’ exh Î”' â†’ oft Î” (var n) A
| oft/abs : oft (cons Î” _ A ğŸ™) M B â†’ oft Î” (abs M) (A -o B)
| oft/app : oft Î”â‚ M (A -o B) â†’ oft Î”â‚‚ N A â†’ merge Î”â‚ Î”â‚‚ Î”
    â†’ oft Î” (app M N) B;

% Environment Î· has domain Î”

LF hasty_env : venv N â†’ lctx N â†’ type =
| hasty_env/n : hasty_env empty nil
| hasty_env/c : hasty_env Î· Î” â†’ hasty W A
    â†’ hasty_env (vcons Î· W) (cons Î” _ A _)

% Value v has type A

and LF hasty : val â†’ tp â†’ type =
| hasty_closure : oft Î” (abs M) A â†’ hasty_env Î· Î”
    â†’ hasty (closure Î· (abs M)) A;